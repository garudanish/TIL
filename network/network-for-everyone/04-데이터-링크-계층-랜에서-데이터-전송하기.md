# 데이터 링크 계층: 랜에서 데이터 전송하기

## 데이터 링크 계층의 역할과 이더넷

데이터 링크 계층: **네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층**

- 랜에서 데이터를 정상적으로 주고받기 위해서 필요하다

### 이더넷이란?

- 이더넷: 랜에서 적용되는 규칙
  - 데이터 링크 계층에서 정하는 규칙들 중 일반적으로 가장 많이 사용된다.
  - 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용한다.
    - 허브를 사용하는 랜 환경에서는 특정한 컴퓨터 한 대에 데이터를 보내려고 해도 다른 모든 컴퓨터에 전기 신호가 전달된다.
    - 이때 데이터를 보호하기 위해 데이터에 **목적지** 정보를 추가해서 보낸다.
      - 목적지 이외의 컴퓨터는 데이터를 받더라도 무시한다.
    - 허브에 연결된 컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 충돌할 수 있다.
  - 이더넷은 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조이다.
    - 이더넷은 데이터를 보내는 시점을 늦추는 방식을 사용한다.
      - 이 방식을 **CSMA/CD** 라고 한다.
      - CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지를 확인한다.
      - MA: 케이블에 데이터가 흐르고 있지 않다면 데이터를 보낼 수 있다.
      - CD: 충돌이 발생하고 있는지를 확인한다.
    - 오늘날은 효율의 이유로 CSMA/CD를 거의 사용하지 않는다.

## MAC 주소의 구조

### MAC 주소란?

- MAC 주소(물리 주소): 랜 카드에 새겨져 있는 전 세계에서 유일한 번호
  - 48비트 숫자로 구성되어 있다.
    - 앞 24비트는 랜카드를 만든 제조사 번호, 뒤 24비트는 제조사가 랜 카드에 붙인 일련번호이다.
- 데이터 링크 계층(= 네트워크 계층)에서는 이더넷 헤더와 트레일러를 붙인다.
  - 이더넷 헤더는 목적지 MAC 주소(6바이트), 출발지 MAC 주소(6바이트), 유형(2바이트) 총 14바이트로 구성되어 있다.
    - 이더넷 유형: 이더넷으로 전송되는 상위 계층 프로토콜 종류를 식별하는 번호.
      - IPv4, ARP, RARP, SNMP over Ethernet, IPv6 등의 프로토콜을 나타내는 16진수 번호가 들어간다.
  - 트레일러: 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용한다. FCS(Frame Check Sequence)라고도 한다.
  - **프레임**: 이더넷 헤더와 트레일러가 추가된 데이터
    - 데이터 링크 계층에서 데이터에 이더넷 헤더와 트레일러를 추가해 프레임을 만들고, 물리 계층에서 프레임 비트열을 전기 신호로 변환해 네트워크를 통해 전송한다.
  - 전송된 데이터의 목적지 MAC 주소와 받는 컴퓨터의 MAC 주소가 다르면, 받는 컴퓨터에서는 데이터를 파기한다.

## 스위치의 구조

### MAC 주소 테이블이란?

- 스위치: 데이터 링크 계층에서 동작한다. 레이어 2 스위치, 스위칭 허브라고도 한다.
  - 스위치 내부에는 MAC 주소 테이블이 있다.
  - **MAC 주소 테이블**: 스위치의 포트 번호와 해당 포트에 연결된 컴퓨터의 MAC 주소가 등록되는 데이터 베이스
    - 컴퓨터에 목적지 MAC 주소가 추가된 프레임 데이터가 전송되면 MAC 주소 테이블을 확인 후 등록되어 있지 않으면 데이터를 보낸 컴퓨터의 MAC 주소를 포트와 함께 등록한다.
    - 이를 **MAC 주소 학습 기능**이라고 한다.
  - **플러딩**: MAC 주소 테이블에 등록되어 있지 않은 주소로 데이터를 보낼 경우, 등록된 포트를 제외한 모든 포트로 프레임을 전송하는 것
  - 만일 MAC 주소 테이블에 목적지 MAC 주소가 등록되어 있다면, 해당 포트에만 프레임이 전송된다.
    - 이를 **MAC 주소 필터링**이라고 한다.

## 데이터가 케이블에서 충돌하지 않는 구조

### 전이중 통신과 반이중 통신

- 전이중 통신 방식: 데이터의 송수신을 동시에 통신하는 방식
  - 데이터를 동시에 전소해도 충돌이 발생하지 않는다.
  - 두 대의 컴퓨터를 랜 케이블로 직접 연결한다면 전이중 통신 방식이다.
- 반이중 통신 방식: 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식
  - 데이터를 동시에 전송하면 충돌이 발생한다.
  - 허브 내부에는 송수신이 나누어져 있지 않기 때문에 반이중 통신 방식을 사용하게 된다.
- 스위치는 충돌이 일어나지 않는 방식, 즉 전이중 통신 방식으로 데이터를 주고받을 수 있다.
  - 따라서 네트워크로 허브 대신 스위치를 사용하는 것이 표준이다.

### 충돌 도메인이란?

- 충돌 도메인: 충돌이 발생할 때 그 영향이 미치는 범위
  - 허브는 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인이 된다.
    - 즉, 연결된 컴퓨터 전체가 충돌의 영향을 받는다.
  - 스위치는 충돌이 일어나지 않고, 충돌 도메인의 범위 역시 좁다.
- 충돌 도메인의 범위가 넓을 수록 네트워크가 지연되므로, 충돌 도메인의 범위를 좁히는 것이 중요하다.

## 이더넷의 종류와 특징

### 이더넷 규격

- `10BASE-T`
  - 10: 통신 속도. 통신 속도가 10Mbps이다.
  - BASE: 전송방식. BASEBAND이라는 전송방식을 사용한다.
  - T: 케이블 종류.
    - 하이픈 뒤는 케이블 길이나 케이블 종류를 나타낸다.
    - 동축 케이블은 케이블의 최대 길이를 100미터 단위로 표시한다.
      - `10BASE5`는 케이블의 최대 길이가 500미터이다.
    - UTP 케이블은 케이블의 종류를 표시한다.
      - `10BASE-T`는 케이블의 종류가 UTP 케이블이다.
- 최근 컴퓨터의 랜 포트는 `1000BASE-T`가 일반적으로, `10GBBASE-T`도 많아지고 있다.
