*본 글은 "구글 엔지니어는 이렇게 일한다" 세션의 발표자료로 쓰인 "프런트엔드 개발을 위한 테스트 입문" 책의 챕터 1, 2 요약본 입니다.*

# 테스트를 작성해야 하는 이유

### 1) 테스트는 서비스 신뢰도를 높인다.


#### 모던 프론트엔드는 Authorization 과 같이 버그에 치명적인 로직에 관여하고 있다.
- 이런 영역에서 버그는 유저 경험에 치명적이다.
- 한 번의 버그로 유저에게 최악의 평가를 받을 수 있다.
- 거꾸로, 이미지 회복은 매우 힘들다.
- ”로그인이 안돼” → “최악이다”

### 2) 테스트는 코드의 유지보수성을 높인다.

#### 남이 만든 공통 모듈을 손대는 일은 정말 두려운 일이다.
- 컴포넌트의 문서화 된 스펙이 없기 때문.
- 테스트 코드가 그 모듈의 스펙이 될 수 있다. 
- 이는 협업에도 굉장한 도움이 된다.

#### 테스트 코드는 의존성을 업데이트 할 때도 요긴하게 사용된다.
- 수많은 라이브러리들이 제각각 업데이트 되는데, 얼마나 변경되었는지 확인해서 일일이 대응하는 것은 매우 어려움.
- 그래서 아무도 라이브러리 업데이트를 하지 않음.
- 디펜다봇을 사용할 수 있다고 하지만, 모든 경우를 대응할 수 없기에
- *”마이너 업데이트는 테스트를 통과하면 병합할 수 있다”* 와 같은 룰을 만들면 좋다.

#### 테스트를 쓰는 것 만으로 코드의 품질을 높일 수 있다.
- 테스트를 처음 작성한다고 해보자.
- 잠깐. 컴포넌트가 하는 일이 너무 많아서 테스트가 어렵네?
- 책임을 분리해줄 때가 왔다.

#### 웹 접근성을 자연스럽게 높여주는 테스트 문법.
- react-testing-library, vue-testing-utils 는 웹 접근성에서 유래한 API 로 돔을 조회한다.
- 시각장애인이 웹을 보듯 접근한다는 의미.
- 테스트를 작성하려면 접근성이 좋은 코드를 짜게된다.

#### 테스트는 코드 리뷰에도 도움을 준다.
- 현실적으로 리뷰어는 PR 속 코드가 기획대로 구현되었는지 정확하게 판단하지 못한다.
- 상대방에 대한 신뢰 + 귀찮음으로 적당히 트집잡고 끝낸다.
- 테스트 코드 자체가 스펙이기 때문에 통과 여부를 확인하여 리뷰를 신속하고 정확하게 마칠 수 있다.

# 테스트를 망설이는 이유

### 1) 테스트 코드 자체의 난이도가 높다.
- 어쩔 수 없다. 
- 다만, 테스트는 참고할 수 있는 코드가 많을 수록 작성이 쉬워진다.
- 처음에만 어렵지 참고할 자료가 쌓이면 장인이 될 것.

### 2) 시간이 부족하다.
- 테스트는 실제로 작업 시간을 잡아먹는다.
- 내가 능숙해졌다고 해도, 팀원 모두가 그렇게 되기 까지 시간이 많이 필요할 것.
- 프론트엔드 코드는 수명이 짧기 때문에 더더욱 테스트 하기를 망설인다.
- 그러나 멀리 보면 테스트는 오히려 작업 시간을 단축시킨다.

#### `기능 구현 16h + 테스트 4h`
- 테스트 4h 동안 버그를 발견할 가능성 높다.

#### `기능 구현 16h`
- 기능 구현만 한 경우 QA 팀이 버그를 발견해 보고하고,
- 수정 후 재검토에 걸리는 시간이 네시간을 넘을 것.

# 테스트 범위

### 정적 분석기
- 깃 훅으로 tsc, eslint 정도는 돌리자.

### 유닛 테스트
- 한 컴포넌트의 책임만을 검사하는 것.

### 통합 테스트
- 주로 유저의 사용 흐름을 정의해서 테스트 한다.
- `셀렉트 박스 조작 → URL 쿼리 파라미터 변경 → 쿼리 변경되어 Fetch 호출 → 응답 데이터로 화면 갱신`

### E2E 테스트
- 통합테스트로 하기 어려운 동작을 테스트한다.
- **특정 위치로 스크롤 시 데이터 호출 여부 확인.**
- **특정 브라우저에서 정상 동작 확인.**
- 등등..

### 시각적 회귀 테스트
- 실제 화면을 캡쳐해서 직전 캡쳐본과 비교하는 테스트.

# 테스트 전략

- 유닛, 통합, E2E 중 어느 것을 강조하느냐.
- 일반적으로 유닛이나 통합 테스트의 비중을 높게 가져가는 것을 추천한다.
- 유닛 테스트가 많으면 빠르고 안정적인 테스트가 가능하다.
- 통합 테스트가 많으면 실제 제품과 유사한 테스트가 가능하다.

# Vitest + Vue Testing Utils 문법 참고 자료
- [[vue 3] 04. vitest를 이용한 단위 테스팅 1](https://goodteacher.tistory.com/685)
- [[vue 3] 05.  vitest를 이용한 단위 테스팅 2](https://goodteacher.tistory.com/686)
- [[vue 3] 06. vitest를 이용한 단위 테스팅 3](https://goodteacher.tistory.com/687)
- [[vue 3] 07. vitest를 이용한 단위 테스팅 4](https://goodteacher.tistory.com/694)
- [[vue 3] 08. VTU를 이용한 vue test](https://goodteacher.tistory.com/692)
