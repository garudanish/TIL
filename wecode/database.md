# 데이터베이스

## 데이터베이스 기본 개념

데이터베이스는 우리가 사용하는 정보의 총 집합이다. 데이터 모음집이다.

데이터들은 보통 데이터베이스 관리 시스템 DBMS Database Management System으로 제어하고 관리한다.

데이터들은 저장장치에 들어있고, 그 데이터를 꺼내서 쓸 수 있도록 도와주는 것이 DBMS이다. 대표적인 DBMS론 mySql, OracleDB 등이다.

## 데이터베이스를 사용하는 이유

**데이터를 가지고 있으려고!**

1. 오랜 기간 저장 및 보존하기 위해서.
   1. 데이터베이스에 파일을 저장하면 휘발되지 않는다. RAM에 저장된 변수 등은 프로그램이 종료되면 가비지 컬렉터 등에 의해 사라진다. 어떤 데이터를 프로그램 종료 이후에도 이어서 계속 사용하려면 DB에 저장해야 한다.
2. 체계적으로 보존하고 관리하기 위해서 사용한다.
   1. 체계적으로 정리되어 입력된다. 따라서 다시 찾고자할 때 어렵지 않게 정보를 얻을 수 있다.

## 관계형 데이터베이스(집중!)

관계형 DB에서 모든 데이터는 스프레드시트와 같은 2차원 테이블로 나타낼 수 있다.

Column(열): 컬럼은 테이블의 각 항목(id, 책 제목, 작가, 출판사, 가격)을 의미한다.

Row(행): 로우는 각 항목들의 실제 값(개미, 베르베르, 열린책들, 11520)들이다.

- 테이블의 가장 첫 컬럼은 언제나 id이다. 각 로우는 저만의 고유 키(PK, Primary Key)를 갖고 있다.
- 다른 로우와 겹치지 않는, 하나의 데이터만 정확하게 지칭할 수 있는 고유한 번호
- Primary Key를 통해 특정 로우를 찾거나, 인용(reference)할 수 있다.

데이터베이스를 구성하는 테이블은 수백, 수천 개가 될 수 있다.

관계형 데이터베이스란 DB를 구성하고 있는 테이블들이 서로 상호관련성을 가지고 연결되어 있다는 의미이다. 즉, 각각의 테이블들이 완전히 독립적이지 않고, 서로 관련이 있다는 뜻이다.

## 테이블 사이 관계의 종류

One to one, one to many, many to many 세 가지가 있다. 관계형 데이터베이스 내부에 테이블 A, 테이블 B가 있을 때, 이 두 테이블은 무조건 세가지 가운데 한 가지에 해당한다.

### 일대일

하나의 A테이블 데이터는 오로지 하나의 B 테이블 데이터와 연결된다. 하나의 B 테이블 데이터 또한 하나의 A 테이블 데이터와 연결된다. 주민등록번호 개념이 정확하다. 일대일 관계이므로 합칠 수 있다.

외래 키 FK, Foreign Key는 다른 테이블의 PK를 쓴다. "Identification numbers 테이블의 user 컬럼은 users 테이블의 id(pk)를 참조한다."라고 표현할 수 있다.

### 일대다

하나의 A 테이블 데이터는 B 테이블의 여러 데이터와 연결된다. 하나의 B 테이블 데이터는 오로지 하나의 A 테이블 데이터와 연결된다.

한 명이 여러 마리의 강아지를 기를 수 있지만, 한 마리의 강아지는 여러 집에 소속해있을 수 없다.

FK가 Many 테이블에 위치해야만 일대다 관계가 성립된다.

`1:1` 은 두 테이블이 서로가 서로의 오로지 한 로우에만 연결되어야만 합니다. `1:N` 은 한 테이블의 로우 하나에 다른 테이블의 로우 여러개가 연결될 수 있습니다.

### 다대다

하나의 A 테이블 데이터는 B 테이블의 여러 데이터와 연결될 수 있다. 하나의 B 테이블 데이터 또한 여러 A 테이블 데이터와 연결될 수 있다.

한 작가는 여러 권의 책을 쓸 수 있다. 한 책에도 작가는 여러 명이 될 수 있다. 책이 한 권 늘어날 때마다, 그 책을 쓴 작가의 수만큼 같은 데이터를 여러번 저장해줘야 하는 문제가 발생한다.

이 문제를 해결하기 위해 중간 테이블을 생성한다. 서로 각자 다른 테이블의 여러 데이터와 연결될 때에는 중간 테이블을 생성해 두 테이블에 속한 데이터의 조합을 입력한다. 최소한의 중복데이터로 만들어야 한다!

중간 테이블은 양 쪽의 테이블에서 FK를 가져온다. 추가 정보가 들어갈 수 있으나, 양 테이블의 FK는 반드시 필요하다.

데이터베이스에 배열을 넣을 수 없다. 한 셀에는 데이터가 무조건 하나만 들어가야 한다. 배열을 해체하는 것을 **정규화**라고 한다.

## Q&A

항상 FK를 안 물고 있는 애부터 시작하는 것이 좋다.

상위 카테고리, 하위 카테고리가 있다면 상위 카테고리는 FK가 없으므로 상위 카테고리부터 만든다. id와 name 필드만 만들면 되니까 훨씬 간단하고 편리하다.

FK 이자 pk로 구현한 방법은 틀렸다. 다른 테이블에 의존하는 것은 좋지 않다. 각 테이블마다 독립적으로 구분할 수 있는 id를 만들어두는 것이 좋다.
